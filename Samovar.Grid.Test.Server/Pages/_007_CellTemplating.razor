@page "/_007_CellTemplating"

@using Samovar.Grid.Test.Server.Components

@inject WeatherForecastService ForecastService

<h1>Cell templating</h1>

<SamovarGrid Data="@data"
             PageSize="20"
             PagerSize="10"
             Height="600px"
             SelectedRowClass="bg-warning" 
             EditMode="GridEditMode.Form">
    <GridColumns>
        <GridColumn Title="Status" Width="38px">
            <CellShowTemplate>
                @{
                    WeatherForecast data = context as WeatherForecast;
                    if (data.Position < 10)
                    {
                        <div class="status-red"></div>
                    }
                    else if (data.Position < 20)
                    {
                        <div class="status-yellow"></div>
                    }
                    else
                    {
                        <div class="status-green"></div>
                    }
                }
            </CellShowTemplate>
        </GridColumn>
        <GridColumn Title="Pos." Field="@nameof(WeatherForecast.Position)" Width="50px"/>
        <GridColumn Title="Date" Width="100px" Field="@nameof(WeatherForecast.Date)">
            <CellShowTemplate>
                @{
                    WeatherForecast data = context as WeatherForecast;
                    <div>@data.Date.ToShortDateString()</div>
                }
            </CellShowTemplate>
        </GridColumn>
        <GridColumn Title="Date2" Field="@nameof(WeatherForecast.Date)" Width="200px">
            <CellShowTemplate>
                @{
                    WeatherForecast data = context as WeatherForecast;
                    <MyCellTemplate Id="data.Position" />
                }
            </CellShowTemplate>
        </GridColumn>
        <GridColumn Title="TemperatureC" Field="@nameof(WeatherForecast.TemperatureC)" Width="200px">
            <CellEditTemplate>
                @{
                    WeatherForecast data = context as WeatherForecast;
                    <select @bind="data.TemperatureC" class="form-control form-control-sm">
                        <option value="10">10</option>
                        <option value="20">20</option>
                        <option value="30">30</option>
                    </select>
                }
            </CellEditTemplate>
        </GridColumn>
        <GridColumn Title="TemperatureF" Field="@nameof(WeatherForecast.TemperatureF)" Width="150px" />
        <GridColumn Title="Summary" Field="@nameof(WeatherForecast.Summary)" Width="150px">
            <CellEditTemplate>
                @{
                    WeatherForecast data = context as WeatherForecast;
                    <input style="width:100%;" type="text" @bind="@data.Summary" @oninput="onInput" />

                    void onInput(ChangeEventArgs args)
                    {
                    }
                }
            </CellEditTemplate>
            <CellShowTemplate>
                @{
                    WeatherForecast data = context as WeatherForecast;
                    <div @onmousedown:stopPropagation="true" @oncontextmenu:preventDefault="true" style="word-break:break-all;">@data.Summary</div>
                }
            </CellShowTemplate>
        </GridColumn>
        <GridCommandColumn Width="120px" />
    </GridColumns>
</SamovarGrid>

@code{
    IEnumerable<WeatherForecast> data;

    protected override async Task OnInitializedAsync()
    {
        data = await ForecastService.GetForecastAsync(DateTime.Now, 1000);
    }
}